=== 第08章: 門倉の記録

四十七キロバイトのテキストファイルが、ノートパソコンの画面に広がっている。

土曜日の午前十一時。瀬川の自宅。三十分前に椎名が来た。私服の椎名は会社で見るのと同じ地味なグレーのTシャツにジーンズで、玄関先で「読むか」とだけ言った。瀬川は頷いて、ラップトップを開いた。

@<tt>{truth.txt}。47,283バイト。改行を含むプレーンテキスト。

日付ごとに記録が並んでいる。最初の日付は二〇二〇年十一月十五日。門倉がクラウドブリッジに入社して七ヶ月目にあたる。

椎名は瀬川の隣に座り、画面を見ている。二人とも無言だった。スクロールを始めた。

//hr

//quote{
2020年11月15日

荻野部長に呼ばれた。会議室Bだった。扉を閉めた瞬間、荻野部長の笑顔が変わった。正確には、変わらなかった。笑顔のまま、全く別のことを話し始めた。

「門倉くん、ちょっとお願いがあるんだ」

ユーザーの行動データを収集する仕組みを作ってほしい、と言われた。BridgeFlowの全APIリクエストをユーザーIDに紐付けて記録するシステム。正規のログとは別に。プライバシーポリシーには記載しない。

断ろうとした。個人情報保護法に触れる可能性があると伝えた。荻野部長は笑顔のままだった。

「門倉くん、まだ試用期間中だよね」

それだけだった。声を荒げなかった。笑顔を崩さなかった。だが試用期間という言葉が何を意味するか、私は理解した。前職を辞めたばかりだった。貯金は二ヶ月分しかなかった。

その夜、最初のコードを書いた。キーボードを打つ指が震えていた。正規のAPIハンドラに、一つの関数呼び出しを追加した。ユーザーIDとリクエストボディとタイムスタンプを、別のテーブルに書き込む関数。テーブル名は @<tt>{_shadow_logs} とした。アンダースコアで始めたのは、正規のテーブル一覧に紛れさせるためだ。

吐き気がした。
//}

瀬川の指がトラックパッドの上で止まる。門倉の文体は淡々としている。記録体。感情を排した客観的な記述。だが最後の一行だけが違う。「吐き気がした」。四文字。

椎名が画面を見ている。表情は変わらない。だが顎の筋肉がわずかに動いた。

スクロールを再開した。

//quote{
2020年12月〜2021年3月

荻野部長の要求は段階的に増えた。ページ遷移の記録。クリック座標の記録。フォーム入力の途中経過の記録。実装するたびに、コードを難読化した。変数名を一文字にした。関数名を無意味な文字列にした。荻野部長は技術が分からない。コードレビューもしない。動けばいい。動くかどうかだけを確認して、笑顔で「いいね、門倉くん」と言った。

難読化は指示通りに施した。ただし、構造は保った。いつか誰かがこのコードを読むときのために、解読可能な構造を残した。
//}

構造は保った。瀬川は自分が書いた四十七本のテストを思い出した。変数名が一文字でも、テストを書けばデータフローを追える。門倉は難読化しながら、解読の糸口を意図的に残していた。

//quote{
2021年6月

荻野部長が関数の追加を要求してきた。フォームの送信前に入力内容をキャプチャする関数。ユーザーが「送信」ボタンを押す前、入力途中のデータも記録する。医療機関の問診票や予約フォームが対象になる。

キーボードを打ちながら、吐き気が止まらなかった。医療情報は機微情報だ。個人情報保護法の要配慮個人情報に該当する。これを無断で記録し、外部に流すことは明確な違法行為だ。

だが断れなかった。試用期間はとうに過ぎていた。だが荻野部長の笑顔は変わらない。「門倉くん、君がいないと困るんだよね」と言われた。この言葉の裏側に何があるか、理解していた。

実装した。関数名は @<tt>{cF} にした。変数名は @<tt>{d}、@<tt>{u}、@<tt>{t}。コードの行数は十五行。テストは書かなかった。書けなかった。だがコメントは残した。「// validate user consent」——ユーザーの同意を検証する、という嘘のコメント。いつか誰かがこのコメントを読み、コードの実装との乖離に気づくはずだ。
//}

//quote{
2021年8月

外山という男が来た。セキュリティコンサルタントを名乗っている。荻野部長は「外部の監査だよ」と紹介した。四半期に一度の定期監査だと言った。

給湯室で偶然、荻野部長と外山の会話を聞いた。正確には聞こえてしまった。

「医療系の行動データは単価が高いんですよ。SaaSの操作ログなんて普通は誰も買わないが、医療機関の業務フローとなると話が変わる」

外山の声だった。荻野部長は低い声で何かを答えた。聞き取れなかった。だが笑い声が聞こえた。二人の笑い声。

BridgeFlowの導入企業には医療機関が含まれている。
//}

椎名の呼吸が変わった。深くなった。短く鼻から息を吐いた。

//quote{
2022年2月

@<tt>{_shadow_logs} のレコード数が三百万を超えた。一日あたり約五千件のペースで増え続けている。削除の指示はない。蓄積する一方だ。

sync_agentのバイナリを外山が持ち込んだ。「セキュリティ監査の一環で、ログのバックアップを取りたい」と荻野部長が説明した。毎晩午前三時にデータを外部サーバーに送信する仕組み。送信先は @<tt>{databridge-analytics.com}。外山のドメインだ。

バイナリはコンパイル済みで、ソースコードはない。私に渡されたのはcronジョブの設定だけだった。

「これ、本番サーバーで動かすんですか」

荻野部長は笑顔で頷いた。「バックアップだよ。万が一に備えて」

外山が言った。「ログは一定期間で自動削除されますから。セキュリティ上、問題ありません」

嘘だと分かっていた。削除などされない。外部に送信されたデータは、どこかで売られる。医療機関の操作ログ。患者の予約パターン。診療科ごとの利用頻度。全てが金になる。

設定した。
//}

三行。月日の記述、事実の列挙、そして「設定した」の一言。二〇二〇年の最初のエントリにあった震えも、吐き気も、もう書かれていない。

//quote{
2022年6月

三島さんが泣いていた。経理フロアの非常階段で、一人で。声を殺して泣いていた。気づかないふりをして通り過ぎた。

巻き込みたくない。巻き込めない。
//}

瀬川はあの非常階段を思い出した。コンクリートの壁と金属の手すり。切れかけた蛍光灯。三島が二年間の恐怖を語った場所。門倉はその二年前に、同じ場所で三島の涙を見ていた。声をかけられなかった。

「知ってたんだな」

椎名が言った。瀬川の手はトラックパッドの上で止まっている。

「門倉は——三島のことを、知ってた」

頷くことしかできなかった。

//hr

エントリは年を追うごとに短くなっていった。二〇二〇年の記録は一つのエントリが数百文字あった。状況の説明、荻野の言葉、門倉自身の判断。だが二〇二二年後半からは数行に縮まり、二〇二三年に入るとさらに削ぎ落とされた。

//quote{
2023年2月

外山の監査レポート。三回目。前回と全く同じ文面。日付だけが変わっている。PDFを開いて、前回のレポートと並べて確認した。コピー&ペースト。一言一句同じだ。

監査など存在しない。
//}

//quote{
2023年4月

@<tt>{_shadow_logs} 八百万行。
//}

//quote{
2023年7月

外山の監査。五回目。レポートは前回と同じだろう。
//}

//quote{
2023年9月

限界だ。
//}

一行。二〇二三年九月のエントリはその三文字だけだった。句点を含めても四文字。門倉のコミットメッセージの変遷と重なった。几帳面なConventional Commitsから、@<tt>{fix} 三文字へ、そして「もう戻れない」へ。言葉が削れていく。人間が削れていく。

椎名は何も言わなかった。画面を見ている。

スクロールを続けた。二〇二三年十月以降、エントリの間隔が広がった。一ヶ月に一度、二ヶ月に一度。門倉が記録をつける気力すら失いかけていたのか、それとも記録する内容がなかったのか。おそらく両方だ。

だが二〇二四年三月、エントリの密度が突然戻った。

//quote{
2024年3月1日

暗号鍵を設計した。このファイルを暗号化して残す。鍵は /legacy/core/ のコードコメントの中に仕込む。// DO NOT TOUCH - K の末尾にスペースを追加する。ファイル名をアルファベット順に並べ、スペース数をインデックスとしてファイル名から文字を取り出せば鍵になる。

リファクタリングできる人間だけが見つけられる。

正確に言えば、リファクタリングしようとする人間だけが見つけられる。コードに触れようとしない人間には見えない。「動いてるから触るな」を真に受ける人間には見えない。.editorconfigの行末スペース設定を気にする人間、コメントの末尾まで確認する人間、ファイル名のアルファベット順に意味を見出す人間。そういう人間が来ることを、待っている。
//}

門倉は待っていた。コードの中に暗号鍵を埋め、ファイルを暗号化し、USBメモリに保存して、「リファクタリングできる人間」が来ることを待っていた。四年間の闇の中で、まだ来ていない誰かを信じていた。

瀬川の推測は正しかった。第7章で暗号鍵を解読したとき、瀬川は「リファクタリングできる人間に向けて隠した」と考えた。今、truth.txtの中で門倉自身がそう書いている。自分の推測が門倉の意図と一致していたことが確認された。

瀬川の目が熱くなった。瞬きをした。画面の文字が一瞬滲んで、元に戻った。

//quote{
2024年3月15日

processor.goの千八百行目にコメントを追加した。

「ここまで読んだなら、もう引き返せない」

ここまで読む人間がいるなら、その人間はもう十分に深く潜っている。_shadow_logsの存在に気づいている。難読化の意図を理解している。引き返す必要はない。引き返してほしくない。
//}

あのコメント。瀬川が深夜の障害対応でprocessor.goを追い、千八百行目で見つけた門倉の言葉。あれは警告ではなく、呼びかけだった。「もう引き返せない」は脅しではない。「ここまで来てくれたのなら、最後まで来てほしい」という祈りだ。

//quote{
2024年3月25日

黒木CTOに全てを話した。暗号鍵の設計を終え、USBメモリにファイルを保存した後、黒木の席に行った。深夜だった。フロアには二人しかいなかった。

黒木は驚かなかった。三年間、自分なりに調査していたと言った。だがコードが読めなかったと。十万行の難読化されたGoコードを前に、手も足も出なかったと。目の下の隈が深かった。

黒木は社外取締役の藤堂真理子に話を通していた。元検察官。コンプライアンス委員長。藤堂は「物的証拠がなければ動けない」と言ったらしい。コードの中の証拠を取り出せる人間が必要だった。

黒木が言った。「後任を探す。コードを読める人間を」

時間がかかるだろう。だが待つしかない。
//}

椎名が小さく頷いた。独り言のように、「三年」と呟いた。黒木が三年間、コードの壁の前で立ち尽くしていたこと。門倉がその壁の向こう側で一人だったこと。二人は同じ建物の中にいて、同じ真実を追いながら、コードという壁に隔てられていた。

//quote{
2024年4月15日

.bf_monitor が仕込まれていた。

今朝、タスクマネージャーを開いたとき気づいた。知らないプロセスが走っていた。名前は @<tt>{.bf_monitor}。調べた。キーストロークの記録、スクリーンショットの定期取得、クリップボードの監視。社用PCの全操作を記録して外部に送信するソフトウェア。いつからあったのか分からない。少なくとも私が暗号鍵を設計した三月以降は動いていただろう。

全部見られていた。暗号鍵の設計過程を除いて——あれは自宅でやった——それ以外の、社用PCで行った全ての操作が。

黒木に電話した。黒木の声は初めて聞くほど低かった。

「逃げろ。今すぐ」

USBは引き出しに残す。暗号化してある。鍵は自分の名前だ。コードを読める人間にしか分からない。それでいい。

逃げる。今夜逃げる。荻野部長が来る前に。
//}

最後のエントリがその下にあった。日付はない。時刻だけが記されている。

//quote{
18:07

Slackに「お疲れ様でした」と書い
//}

文章はそこで途切れていた。

//quote{
18:12

彼らが来
//}

最後の文字は「来」で終わっている。句点もない。変換途中のまま中断されたのか、それとも打ちかけの文字がそのまま保存されたのか。「彼らが来た」なのか「彼らが来る」なのか。

画面の前で、瀬川は動けなかった。

「お疲れ様でした」。Slackの最後の発言。入社初日に見つけた、門倉の最後の言葉。あれは退職の挨拶ではなかった。逃亡の直前に打たれたメッセージだった。十八時七分にSlackに書き込みを始め、十八時十二分に「彼らが来」——五分間の空白。そのあいだに何があったのか。

喉が渇いていた。唾を飲み込もうとしたが、喉が張り付いている。

ラップトップの画面を閉じた。手が震えている。手首から指先にかけて、細かい振動が止まらない。拳を握った。爪が掌に食い込む。

椎名は黙っていた。五秒。十秒。三十秒ほどの沈黙が部屋を満たした。窓の外で鳥が鳴いていた。土曜の正午前。外は晴れていた。梅雨の合間の晴天。

「深夜二時から四時」

椎名が言った。

「コミット時刻。門倉のコードは全部、深夜に書かれてた。荻野に命じられた不正なコードを、毎晩、あの時間に」

瀬川は頷いた。truth.txtには書かれていなかった——深夜の作業のことは。だが行間にそれがあった。門倉は昼間は正規の業務をこなし、夜に不正なコードを書かされていた。git blameの時刻がその証拠だ。truth.txtに書く必要がなかったのは、コードそのものが記録だったからだ。

//hr

日曜日。瀬川は一人で部屋にいた。truth.txtを二度読み直した。初読で見落としていた細部を拾うためだった。椎名は昨日の夕方に帰った。帰り際に「月曜、確認することがある」と言った。何をとは聞かなかった。瀬川にも同じ考えがあった。

@<tt>{.bf_monitor}。

門倉の記録には明確に書かれていた。社用PCに監視ソフトが仕込まれていたこと。キーストロークの記録、スクリーンショットの定期取得、クリップボードの監視。そして黒木の暗示——「お前のPCにおかしなプロセスが走っていないか確認しておけ」。

二つの線がつながった。門倉のtruth.txtと、黒木の言葉。同じものを指していた。

月曜日に確認する。自分のPCにも同じものがあるかどうかを。

//hr

月曜日。七月一日。瀬川は平常通りの時刻に出社した。

オフィスの自動ドアをくぐり、エレベーターで七階へ上がり、自分のデスクに着いた。ノートパソコンを開く。電源ボタンを押す。Windowsのログイン画面。パスワードを入力する。デスクトップが表示される。

いつもと同じ動作。いつもと同じ画面。だが今日は違う。瀬川は門倉の四年間を知っている。この画面の裏で何が動いているかを知っている——いや、まだ確認していない。確認しなければならない。

タスクマネージャーを開いた。@<tt>{Ctrl + Shift + Esc}。プロセスの一覧が表示される。通常業務の一環としてパフォーマンスを確認している——そう見えるように、Grafanaのダッシュボードも隣のタブで開いておく。

プロセスを名前順でソートした。A、B、C……。

@<tt>{.bf_monitor}。

あった。

プロセスの一覧の中に、ドットで始まるプロセス名。@<tt>{.bf_monitor}。CPU使用率は0.1%未満。メモリ使用量は14MB。目立たない。意図的に目立たないように設計されている。

「詳細」タブを開いた。プロセスの起動時刻——六月四日。火曜日。

瀬川が入社したのは六月三日の月曜日だ。@<tt>{.bf_monitor} は入社翌日から動いていた。

三週間と五日。瀬川がクラウドブリッジで過ごした全ての日に、このプロセスは起動していた。キーボードを打つたびに、画面を切り替えるたびに、記録されていた。

指先が冷たくなった。タスクマネージャーを閉じ、Grafanaのダッシュボードに視線を戻した。何事もなかったかのように。

社用PCでの行動を振り返った。@<tt>{_shadow_logs} へのSQLクエリ。cronジョブの調査。@<tt>{sync_agent} の設定ファイル確認。TLS証明書の参照。git blameの実行。全てこの社用PCで行っていた。全て記録されていた可能性がある。

だが——最も重要な作業は、ここでは行っていなかった。truth.encの復号は自宅の私用ラップトップで行った。暗号鍵の解読も自宅で行った。truth.txtを読んだのも自宅だ。椎名へのメッセージは私用のスマートフォンから送った。

黒木の忠告に従って、核心的な作業を社用端末から切り離していたことが、結果的に自分を守っていた。あの断片的な警告がなければ、瀬川はtruth.encを社用PCで復号しようとしていたかもしれない。暗号鍵をターミナルに打ち込み、truth.txtを開き、全てを.bf_monitorに記録されていたかもしれない。

背筋に冷たい汗が滲んだ。

@<tt>{.bf_monitor} を停止することはしなかった。タスクを終了させれば、監視する側に「気づかれた」ことが伝わる。泳がせる。今まで通りの行動を続ける。社用PCでは通常業務だけを行い、調査は全て私用端末で進める。

表面は変えない。

//hr

午後二時。荻野が瀬川のデスクに向かって歩いてくるのが、視界の端に映った。

穏やかな笑顔。ビジネスカジュアルのジャケットの襟元に、青いストライプのタイが覗いている。歩き方は落ち着いている。急いではいない。

「瀬川くん、ちょっといいかな」

名前を呼ぶ。いつもそうだ。荻野は必ず名前を呼ぶ。距離を詰めるように、親しみを込めるように。

「はい」

瀬川は椅子から立ち上がった。

荻野は会議室Bに向かった。ガラス張りの小さな部屋。荻野がドアを開け、瀬川を先に通し、自分もドアをくぐり、後ろ手に閉めた。二人きりの空間。エアコンの低い唸りだけが聞こえる。

荻野はテーブルの向かい側に座らなかった。瀬川と同じ側の、一つ隣の椅子に腰を下ろした。距離が近い。肩が触れるほどではないが、会議のための間合いではない。

「最近、残業が多いみたいだけど」

笑顔。声は穏やかだ。

「何か困ってることがあれば言ってくれていいんだよ。入ったばかりで、分からないことも多いだろうしね」

部下を気遣う上司の言葉。表面上は。

「ありがとうございます。コードの量が多いので、キャッチアップに時間がかかっています」

嘘ではなかった。十万行のGoコードを読むのに残業が必要なのは事実だ。ただし、読んでいる対象が違う。

荻野は頷いた。

「門倉くんのコードは難しいだろう。あの子はね、まあ、独特な書き方をする人だったから。無理に全部読まなくていいよ。動いている部分は動いているんだから」

動いているから触るな。入社初日に聞いた言葉と同じだ。繰り返される。何度でも繰り返される。

「はい」

「それとね、瀬川くん」

荻野の声のトーンが変わらなかった。変わらないことが、不気味だった。笑顔のまま。目元の皺の入り方まで同じだ。

「まだ試用期間中だよね」

心臓が跳ねた。一拍だけ。

truth.txtの最初のエントリが脳裏に浮かんだ。二〇二〇年十一月十五日。門倉が会議室に呼ばれた日。荻野が笑顔のまま言った言葉。「門倉くん、まだ試用期間中だよね」。四年前の門倉と、今の瀬川。同じ言葉。同じ笑顔。同じ会議室かもしれない。

@<tt>{.bf_monitor} が見ている。このPCにはカメラがある。スクリーンショットが定期的に撮られている。表情を変えてはいけない。

「はい。九月末までです」

声は安定していた。自分でも驚くほど平坦に出た。

「うちは人柄を大事にする会社だからね。余計な心配をさせたくないんだ」

笑顔。声を荒げない。だが「試用期間」と「余計な心配」の二つの単語が、見えない圧力として空気を圧迫していた。門倉はこの圧力の中で四年間を過ごした。毎日。毎晩。深夜のオフィスで、荻野に命じられたコードを書きながら。

「ありがとうございます」

リファクタリングと同じだ——外側のインターフェースは変えずに、内部実装だけを書き換える。荻野に見えるインターフェース——従順な新入社員、上司の忠告に素直に従う若手エンジニア——はそのまま維持する。内部では全てが変わっている。truth.txtを読んだ。@<tt>{.bf_monitor} を見つけた。門倉の四年間を知っている。だがインターフェースは変えない。

荻野の目が一瞬だけ細くなった。満足したのか、疑っているのか。瀬川には判別がつかなかった。

「うん。頑張ってね、瀬川くん」

荻野が立ち上がった。ドアを開ける。先に出るように促される。瀬川は会議室を出た。背中に荻野の視線を感じた。後頭部から首筋にかけて、見られている感覚。門倉は四年間、毎日この視線を浴びていたのだ。

自分のデスクに戻った。椅子に座る。モニターの前で、キーボードの上に手を置いた。指が微かに震えていた。トラックパッドに触れないようにした。震えが止まるまで。

斜め向かいの席で、佐々木がこちらを見た気がした。視線を合わせなかった。佐々木の正体が分からない。荻野が送り込んだ監視者なのか、それとも別の何かなのか。入社初日からの不自然な情報通ぶり。門倉のデスクについて知っていたこと。瀬川の画面を覗いていたこと。全てが説明を求めている。

だが今は判断しない。情報が足りない。

椎名の席を見た。椎名は画面に向かっている。いつも通りだ。目が合った。椎名は一度だけ瞬きをした。それだけで十分だった。

//hr

昼休み。瀬川はオフィスを出た。

駅前のコンビニに入った。雑誌コーナーの裏、プリペイドSIMカードの棚。データ通信専用、三十日間有効、一GB。千八百円。手に取った。レジで現金で支払った。レシートは受け取らなかった。

オフィスビルの裏手のベンチに座った。私用のスマートフォンにSIMを差し替える作業は帰宅後にする。まず匿名のメールアカウントを作る必要がある。フリーWi-Fiは使わない。自宅の回線で作成する。

帰宅後、プリペイドSIMを私用のスマートフォンに挿入した。匿名のメールアドレスを作成した。椎名には別経路で伝えてある匿名アドレスがある。そちらに一通目を送った。

件名なし。本文は一行。

「社用端末は全て監視されています。.bf_monitorというプロセスが走っています。入社翌日から」

送信。三分後に返信が来た。

「そうだろうと思った」

椎名の返信は七文字だった。驚きはなかった。椎名は半年前から外山のアクセスを監視していた人間だ。社用PCに監視ソフトが入っている可能性を、とうに想定していたのだろう。

続けて椎名からもう一通。

「今後、核心的な情報のやり取りはこの経路で」

瀬川は「了解」と返した。

秘密通信網が構築された。社用端末の外側に、荻野の目が届かない回線ができた。プリペイドSIMと匿名メールアドレス。昼はオフィスで通常業務を装い、夜は私用端末で真実を追う。門倉が四年間強いられた二重生活の構造と同じだ。だが門倉は一人だった。瀬川は一人ではない。

佐々木のことを考えた。佐々木には何も漏らしていない。核心的な情報は共有していない。だが佐々木を完全に遮断するのも得策ではない。荻野が送り込んだスパイならば、排除すれば荻野が警戒する。佐々木が別の何かであるならば、切り捨てることで味方を失う。

佐々木には核心を見せない。だが通常の距離感は維持する。反応を観察する。月曜のランチで何気ない話をする。荻野との距離感を見る。荻野の指示を受けているなら、何らかの兆候が出るはずだ。データを集める。判断は後からでいい。

窓の外を見た。七月の夕暮れ。梅雨はまだ明けていない。だが今日は晴れていた。空は赤く染まり始めている。低い雲が西の空に積み重なり、その隙間から夕日が差し込んでいる。

truth.txtを読み終えた。門倉の四年間を知った。@<tt>{.bf_monitor} を見つけた。荻野の手口を、門倉が受けた圧力を、身をもって追体験した。「試用期間中だよね」。同じ言葉。同じ笑顔。

門倉は四年間、一人で耐えた。最後には逃げるしかなかった。だが門倉は逃げる前に、コードの中に全てを残した。暗号鍵を仕込み、truth.txtを暗号化し、USBメモリを引き出しに残した。そして「リファクタリングできる人間」が来ることを信じた。

瀬川はその人間として、ここにいる。

スマートフォンの画面を消した。プリペイドSIMの電波強度を示すアイコンが消え、画面が暗転した。指紋が残った画面に、窓の外の夕焼けが薄く映り込んでいる。

全てが疑わしい世界の中で、信じられるものが二つだけある。コードと、椎名。

門倉の最後のエントリが頭を離れない。「彼らが来」で途切れた文字列。句点のない、未完の文。あの瞬間、門倉のキーボードの上で何が起きたのか。

その答えを、コードの中から掘り起こす。門倉がそうしたように。
