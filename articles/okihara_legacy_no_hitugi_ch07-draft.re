== 第07章: 暗号鍵

雨が止んでいた。

アパートのドアを閉め、靴を脱ぎ、鞄を床に置く。六月の四週目の金曜日。帰り道で気づいた。傘を差していたのに、駅を出たあたりから水滴が落ちてこなくなっていた。折り畳み傘を閉じるタイミングが分からないまま、アパートの階段を上った。

鞄から茶封筒を取り出し、本棚の裏に挟んだ。三島の二年分の記録。中身は一昨日の夜に全て確認してある。請求書、登記簿、送金記録。荻野個人口座への毎月八十万から百万円。外山口座への五十万から七十万円。技術的証拠と財務的証拠は揃った。だが足りないものがある。

六畳一間のワンルーム。ベッドとデスクとユニットバス。家賃六万二千円。前職のスタートアップが潰れたあと、貯金三ヶ月分で借りた部屋だ。デスクの上にはThinkPadと外付けモニター、コーヒーメーカー。それだけの空間。窓は北向きで、ガラスの外側に雨の水滴が残っている。街灯の光が水滴に映り込んで、曇ったガラスの表面に小さな光の粒が散らばっている。

ThinkPadを開いた。画面が灯る。

USBメモリは鞄のポケットの中にある。黒い筐体に油性ペンで「開けるな」。あの中に @<tt>{truth.enc} が眠っている。暗号化されたまま。鍵がなければ開かない。

鍵は、コードの中にある。

//hr

きっかけは @<tt>{.editorconfig} だった。

先週の金曜、@<tt>{/legacy/core/} のディレクトリ構造を自宅のラップトップで確認していて目に入った。リポジトリのクローンは社用ではなく、私用の端末に取ってある。黒木の暗示——「おかしなプロセスが走っていないか確認しておけ」——を受けて、調査は全て社外で行う方針にしていた。

ルートディレクトリの @<tt>{.editorconfig} にはプロジェクト共通の設定が書かれている。コードのインデントやエンコーディングを統一するためのファイル。その中の一行。

//emlist{
trim_trailing_whitespace = false
//}

行末の空白を自動で削除しない。

プロジェクトの他のディレクトリの @<tt>{.editorconfig} を確認した。@<tt>{/internal/} は @<tt>{true}。@<tt>{/api/} も @<tt>{true}。@<tt>{/cmd/} も @<tt>{true}。全てのディレクトリで @<tt>{trim_trailing_whitespace = true} になっている。コードの行末に意味のない空白が残っていたら自動で消す。それが普通だ。

なぜ @<tt>{/legacy/core/} だけ、わざわざ無効にしてあるのか。

行末の空白を残す必要がある。削除されたら困るものがある。

@<tt>{cat -A} はファイルの制御文字を可視化するコマンドだ。行末にはドル記号が付く。空白は目に見えないが、@<tt>{cat -A} を通せばドル記号の手前に空白文字が並ぶ。

先週の金曜の夜、最初のファイルを開いた。@<tt>{auth_handler.go}。

//emlist[][bash]{
cat -A /legacy/core/auth_handler.go | head -1
//}

//emlist{
// DO NOT TOUCH - K   $
//}

@<tt>{K} の後にスペースが三つ。ドル記号の手前に三つの空白。

次のファイル。

//emlist[][bash]{
cat -A /legacy/core/batch_runner.go | head -1
//}

//emlist{
// DO NOT TOUCH - K$
//}

スペースはゼロ。@<tt>{K} の直後にドル記号。

三つ目。@<tt>{cache_manager.go}。

//emlist[][bash]{
cat -A /legacy/core/cache_manager.go | head -1
//}

//emlist{
// DO NOT TOUCH - K  $
//}

スペース二つ。

三つのファイルで三つの異なる数字。偶然ではない。

そこからの作業は地道だった。三十七ファイルの一つ一つに @<tt>{cat -A} をかけ、コメント末尾のスペース数をノートに記録していく。土曜の朝から始めて、日曜の昼に終わった。途中でスクリプトを書こうかと思ったが、やめた。目で見て、数えて、手で書く。門倉がコメントに何を仕込んだのか、一つずつ確認したかった。門倉が一行一行コードを書いたように。

ノートを広げた。見開きの左ページに、三十七個のファイル名がアルファベット順に並んでいる。右ページには、それぞれの @<tt>{// DO NOT TOUCH - K} コメント末尾のスペース数。

//emlist{
auth_handler.go       3
batch_runner.go       0
cache_manager.go      2
config_loader.go      5
data_processor.go     2
event_bridge.go       1
flag_controller.go    8
...
//}

三十七ファイル。三十七個の数字。ランダムではない。何かの法則がある。

門倉は @<tt>{.editorconfig} で行末スペースの自動削除を無効にし、三十七個のファイルのコメント末尾にそれぞれ異なる数のスペースを埋め込んでいた。

数字が何を意味するのか。先週の時点では分からなかった。今夜、ここで解く。

//hr

コーヒーメーカーのスイッチを入れた。豆を挽く音が六畳の部屋に響く。小さな部屋だから、コーヒーの匂いがすぐに充満する。マグカップに注ぐ。黒い液面に天井の蛍光灯が映っている。

一杯目。二十一時三十分。

ノートのスペース数を眺める。三十七個の数字の列。@<tt>{3, 0, 2, 5, 2, 1, 8, ...}

最初に試したのはASCIIコードへの直接変換だった。各スペース数を文字コードとして読む。ASCIIコード表を画面に表示する。コード0はNULL。コード1はSOH。コード2はSTX。コード3はETX。全て制御文字だ。スペース数は最大でも二十程度。ASCII表の0から31は制御コードの領域で、表示可能な文字は32のスペースから始まる。ファイルのコメント末尾にスペースを三十二個以上入れる設計にはなっていない。

棄却。ノートに横線を引いた。

二十二時。コーヒーの二杯目を淹れた。マグカップを持ち上げると、底にリング状の染みがデスクの上に残った。拭かなかった。

ファイル名の先頭文字にスペース数をオフセットとして足す。@<tt>{auth_handler} の先頭文字は @<tt>{a}。@<tt>{a} のASCIIコードは97。97 + 3 = 100。100は @<tt>{d}。次、@<tt>{batch_runner} の先頭は @<tt>{b}。98 + 0 = 98。@<tt>{b}。次、@<tt>{cache_manager} の @<tt>{c}。99 + 2 = 101。@<tt>{e}。

@<tt>{d}, @<tt>{b}, @<tt>{e}——@<tt>{dbe...} 。意味をなさない。

先頭文字から引いてみる。@<tt>{a} - 3 は負の値になる。アルファベットの範囲を超える。モジュロ演算で26の剰余を取る。(97 - 3) % 26 = 94 % 26 = 16。16番目のアルファベットは @<tt>{q}。@<tt>{q}, @<tt>{b}, @<tt>{a}——やはり意味がない。

棄却。横線。

ペンをノートの上に置く。椅子の背もたれに体重を預けた。天井を見上げる。蛍光灯の白い光が目に痛い。

次の仮説。各ファイル名のスペース数番目の文字を取る。0-indexedか1-indexedか。プログラマーの感覚なら0-indexed。@<tt>{auth_handler} の0番目は @<tt>{a}。@<tt>{batch_runner} の0番目は @<tt>{b}。@<tt>{cache_manager} の0番目は @<tt>{c}。——それだと単にアルファベット順のファイル名の先頭文字を取っているだけだ。

ではスペース数をインデックスとして使う。@<tt>{auth_handler} のスペース数は3。0-indexedで3番目は @<tt>{h}。@<tt>{batch_runner} のスペース数は0。0番目は @<tt>{b}。@<tt>{cache_manager} のスペース数は2。2番目は @<tt>{c}。

@<tt>{h}, @<tt>{b}, @<tt>{c}——意味がない。

棄却。

鼻から息を吐いた。首を左右に回す。右の肩甲骨の下あたりが固くなっている。デスクワークの姿勢が続いている。立ち上がって、腕を伸ばした。窓の外は暗い。雨は止んだままだが、空は厚い雲に覆われている。月も星も見えない。六月の夜。

コーヒーメーカーに水を足した。三杯目。時計を見た。午前一時十二分。いつの間にか三時間が経っていた。

//hr

午前一時十二分。

コーヒーの湯気がラップトップの画面に薄い曇りを残す。それを袖で拭いた。ノートの見開きを眺める。三十七のファイル名。三十七の数字。十数個の仮説の残骸。横線が並んでいる。ノートの右ページの半分以上が斜線と横線で埋まっている。

目が乾いている。瞬きの回数が減っているのが分かる。画面を見続ける目の奥に、鈍い圧迫感がある。肩を回した。右肩が鳴った。

プログラマーとして考えろ。

門倉律はGoエンジニアだった。四年間、毎晩深夜にコードを書き続けた。難読化されたコードの中に @<tt>{_shadow_logs} への導線を埋め、テストを書く人間が解読できるように設計した。暗号鍵の隠し方も同じ発想のはずだ。

「リファクタリングできる人間」に向けて隠した。外注が失敗したリファクタリング。門倉はそれを前提にしていた。自分の後に来る誰かが、このコードを最初から読み直し、テストを書き、変数名を発掘し、構造を理解する——その過程で気づくような仕組み。

複雑な暗号は使わない。門倉が選ぶのはもっとシンプルな方法だ。コードに向き合う人間なら誰でも解ける方法。ただし、コードに向き合わない人間には永遠に見えない方法。

門倉はGo言語で十万行のコードを書いた。そのうち @<tt>{legacy/core} の二万行は意図的に難読化されている。ファイル名は難読化されていない。@<tt>{auth_handler.go}、@<tt>{batch_runner.go}、@<tt>{cache_manager.go}——ファイルの役割がそのまま名前になっている。Goの命名規則に従ったスネークケース。

ファイル名は信頼できる。

三十七のファイル名がアルファベット順に並んでいる。三十七のスペース数がある。スペース数はインデックス。ファイル名の何番目の文字を取るか。

さっき試した。@<tt>{auth_handler} の3番目は @<tt>{h}。@<tt>{batch_runner} の0番目は @<tt>{b}。@<tt>{cache_manager} の2番目は @<tt>{c}。@<tt>{h}, @<tt>{b}, @<tt>{c}。意味がない——。

待て。拡張子を除いていなかった。

いや、除いていた。@<tt>{auth_handler.go} の @<tt>{.go} を除いて @<tt>{auth_handler}。十二文字。0-indexedで3番目は @<tt>{h}。合っている。それは変わらない。

だが三十七ファイル全てのスペース数をまだ並べていない。さっきは最初の三つだけで棄却した。@<tt>{h}, @<tt>{b}, @<tt>{c} の三文字だけを見て意味がないと判断した。三文字で意味のある単語を期待していた。だが門倉が埋めたのはもっと長い文字列かもしれない。

全てを並べてみる。

シェルスクリプトを書いた。

//emlist[][bash]{
#!/bin/bash
files=$(ls /legacy/core/*.go | sort)
for f in $files; do
  basename=$(basename "$f" .go)
  spaces=$(head -1 "$f" | sed 's/.*K//' | tr -d '\n' | wc -c)
  char=${basename:$spaces:1}
  echo "$basename[$spaces] = $char"
done
//}

Enter。

画面に結果が流れ始めた。

//emlist{
auth_handler[3] = h
batch_runner[0] = b
cache_manager[2] = c
config_loader[5] = g
data_processor[2] = t
event_bridge[1] = v
flag_controller[8] = l
//}

七行。@<tt>{h}, @<tt>{b}, @<tt>{c}, @<tt>{g}, @<tt>{t}, @<tt>{v}, @<tt>{l}。ここだけを見ても分からない。

スクロールを続ける。画面の中程から下まで、三十七行の出力が並んでいる。一行一行、ファイル名とインデックスと抽出文字。ノートに書き出すか迷って、やめた。全体を一度に見る必要がある。

スクリプトを修正した。@<tt>{echo} の行を @<tt>{printf "$char"} に変え、ループの外に @<tt>{echo} で改行を一つ足す。

//emlist[][bash]{
#!/bin/bash
files=$(ls /legacy/core/*.go | sort)
for f in $files; do
  basename=$(basename "$f" .go)
  spaces=$(head -1 "$f" | sed 's/.*K//' | tr -d '\n' | wc -c)
  char=${basename:$spaces:1}
  printf "$char"
done
echo
//}

Enter。

一行の文字列が表示された。

//emlist{
kadokuraritsu2024
//}

画面の文字列を見た。見て、見続けた。

@<tt>{k}——。

@<tt>{k}, @<tt>{a}——。

@<tt>{k}, @<tt>{a}, @<tt>{d}——。

@<tt>{k}, @<tt>{a}, @<tt>{d}, @<tt>{o}, @<tt>{k}, @<tt>{u}, @<tt>{r}, @<tt>{a}——。

kadokura。

指がキーボードの上で止まった。動かない。画面の文字列が目の前にある。十七文字。白い文字。黒い背景。ターミナルのプロンプトの上に、一行だけ。

kadokura ritsu 2024。

門倉律。ローマ字のフルネームと、年号。

椅子の背もたれが軋んだ。体が前に倒れていた。画面に顔が近づいている。ターミナルの文字列まで三十センチもない。モニターの熱が顔に当たっている。

三十七個のファイル名をアルファベット順に並べ、コメント末尾のスペース数を0-indexedのインデックスとしてファイル名から一文字ずつ取り出す。三十七の文字のうち、有効なのは十七文字。残りの二十個は使われない位置を指すダミーか、ファイル名の長さの範囲内で無意味な文字を返す位置に設定されている。有効な十七文字が並んだとき、門倉の名前が現れる。

@<tt>{kadokuraritsu2024}

門倉はこれを暗号鍵にした。自分の名前を。コードの中に。三十七個のファイルに分散させて。@<tt>{.editorconfig} で空白の自動削除を無効にして。四年間、誰にも気づかれないまま。

キーボードの上で指先が細かく振動している。マグカップに手を伸ばそうとして、途中で止めた。指に力が入らない。

時計を見た。

午前三時七分。

ラップトップの時計の数字を見つめた。03:07。門倉がコードを書いていた時間帯の真ん中だ。深夜二時から四時。四年間、毎晩。git blameに刻まれた三千回近いコミットの、あの時間帯。瀬川が暗号鍵にたどり着いたこの瞬間は、門倉がキーボードに向かっていた闇の時間と重なっている。

//hr

鞄のポケットからUSBメモリを取り出した。

黒い筐体。油性ペンの手書き。「開けるな」。

ラップトップのUSBポートに挿した。マウントされる。ファイルは一つだけ。@<tt>{truth.enc}。OpenSSL暗号化。

ターミナルにコマンドを打った。

//emlist[][bash]{
openssl enc -d -aes-256-cbc \
  -in /mnt/usb/truth.enc \
  -out ~/truth.txt \
  -pass pass:kadokuraritsu2024 \
  -pbkdf2
//}

指がキーを押す感触を一つずつ意識している。@<tt>{k}, @<tt>{a}, @<tt>{d}, @<tt>{o}, @<tt>{k}, @<tt>{u}, @<tt>{r}, @<tt>{a}, @<tt>{r}, @<tt>{i}, @<tt>{t}, @<tt>{s}, @<tt>{u}, @<tt>{2}, @<tt>{0}, @<tt>{2}, @<tt>{4}。十七文字のパスフレーズ。門倉の名前。

Enter。

エラーは出なかった。

プロンプトが返ってきた。何事もなかったかのように。@<tt>{$} の点滅。

//emlist[][bash]{
ls -la ~/truth.txt
//}

//emlist{
-rw-r--r-- 1 segawa segawa 47283  6月 28 03:08 truth.txt
//}

47,283バイト。テキストファイル。門倉がこのファイルに付けた名前。truth。真実。

47KBのプレーンテキスト。原稿用紙に換算すれば五十枚から六十枚。門倉が四年間の記録を残すには短い。だが門倉のコミットメッセージを思い出す。初期のConventional Commitsから、最後の「もう戻れない」まで。門倉は言葉を削る人間だった。必要なことだけを書く。47KBに収まったのは、門倉が書くべきことだけを書いたからだ。

@<tt>{head -5 truth.txt} を打とうとして、指が止まった。

@<tt>{h}, @<tt>{e}, @<tt>{a} ——そこでキーボードから手を離した。

椅子の背もたれに体を預ける。天井を見上げた。蛍光灯の白い光。

47KBのテキストファイル。門倉がUSBメモリに暗号化して残した記録。暗号鍵に自分の名前を使った。コードの中に、三十七個のファイルに分散させて、@<tt>{// DO NOT TOUCH - K} の末尾に隠した。「リファクタリングできる人間」だけが見つけられるように。

一人で読むべきではない気がした。

これは門倉の四年間だ。孤独の記録だ。一人で読んで、一人で抱え込んだら、門倉がやったことと同じになる。門倉は一人だった。四年間、深夜のオフィスで、誰にも見せられないコードを書き続けた。瀬川はそうではない。隣の席に椎名がいる。

ラップトップの画面を閉じた。

//hr

私用のスマートフォンを手に取った。メッセージアプリを開く。椎名悟の名前をタップする。社用端末ではない。プリペイドSIMでもない。私用の端末、私用のアプリ。監視の外にある回線。

午前三時十九分。金曜の深夜——いや、土曜の未明だ。椎名が起きているはずがない。

画面のキーボードで文字を打った。

「USBメモリの暗号を解く鍵が見つかりました」

送信。吹き出しが画面の右側に現れる。青いチェックマーク。配信済み。

椎名のアイコンは灰色のデフォルト画像のままだ。プロフィール名は「椎名」の二文字だけ。飾りのない画面。

既読にはならない。当然だ。午前三時に。

スマートフォンを机の上に置いた。画面を上にして。椅子の背もたれに体を預ける。天井を見上げた。白い天井。蛍光灯は消してある。ラップトップの画面は閉じた。部屋の中で唯一の光源はスマートフォンの画面だ。メッセージアプリの白い背景が天井に薄い光の四角を投げかけている。

秒数を数えていた。無意識に。一、二、三——。

画面が暗転した。自動ロック。部屋が闇に落ちた。

目を閉じた。暗闇の中に、ターミナルの文字列が残像として浮かんでいる。@<tt>{kadokuraritsu2024}。白い文字。黒い背景。

振動。

スマートフォンが震えた。机の上で、低い音を立てて。拾い上げる。画面が灯る。

椎名悟。既読。返信。

「そうか」

二文字。句点なし。それだけ。午前三時二十一分。送信から二分。椎名は起きていた。金曜の深夜——土曜の未明に。

三点リーダが表示されている。椎名がまだ何か打っている。吹き出しの下で、三つの点が左右に揺れている。

十秒。二十秒。

メッセージが届いた。

「明日、読もう」

四文字。

椎名は「読もう」と書いた。「読め」でも「読んでくれ」でもない。「読もう」。一人称複数。一緒に。

スマートフォンを手の中で握った。画面の光が指の間から漏れている。返信を打った。

「はい」

二文字。それで十分だった。

//hr

USBメモリをラップトップから抜いた。黒い筐体を手の中で転がす。軽い。数グラム。その中に47KBのテキストファイルがある。門倉の四年間が47KBに収まっている。

「開けるな」の文字を親指でなぞった。油性ペンのインクは乾ききって、指で触れても滲まない。

開けるな。

だがこのラベルの本当の意味は、「開けてくれ」だったはずだ。暗号鍵をコードの中に隠した人間が、本当にファイルを開いてほしくないなら暗号鍵は必要ない。USBメモリを捨てればいい。データを消去すればいい。だが門倉はUSBを残し、鍵を残した。三十七個のファイルのコメント末尾に、スペースの数として、自分の名前を埋め込んだ。見つけてほしかったのだ。四年間の記録を、誰かに読んでほしかったのだ。

「開けるな」は、祈りだ。

USBメモリをデスクの引き出しにしまった。引き出しを閉じる。木の引き出しが枠に収まる小さな音。ラップトップの電源を落とした。ファンの回転が止まり、かすかな高周波のノイズが消える。部屋が完全に暗くなる。

立ち上がって、窓のカーテンを開けた。

雨が止んでいた。帰り道で気づいたのと同じだ。だが今は空が違う。雲が切れている。六月に入ってから、初めてだった。三週間、ずっと灰色の空しか見ていない。毎朝、窓を開けると湿った空気が肌に貼りつき、夜は雨の音がガラスを叩いていた。その空に切れ間がある。厚い雲の層に、一本の裂け目のような隙間。その奥に月が見えた。半月よりやや太い。上弦を過ぎたあたり。白い光が雲の縁を照らし、縁の部分だけが薄く輝いている。

窓ガラスには水滴が残っている。雨の痕跡。だが今、水滴の一つ一つに月の光が映り込んでいる。小さな白い点が、窓の表面に散らばっている。水滴と光。雨の記憶と、雨の終わり。

午前三時三十分。

まだ全ては終わっていない。@<tt>{truth.txt} の中身は読んでいない。47KBのテキストの中に何が書かれているのか、分からない。荻野の証拠隠滅の動きは加速している。三島の封筒だけでは足りない。技術的証拠の核心——@<tt>{truth.txt}——は復号できた。あとは読むだけだ。

明日、椎名と。

窓の外の月を見ている。雲がゆっくりと流れて、月が隠れ、また現れる。完全に晴れたわけではない。雲の合間から覗く光だ。だがそれで十分だった。

鍵は見つかった。

それだけで、今夜は十分だった。
